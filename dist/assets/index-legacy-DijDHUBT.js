System.register([],function(e,t){"use strict";return{execute:function(){const e=[{id:1,name:"Estambul",country:"Turquía",bestMonths:"Abril-Mayo, Septiembre-Octubre",festivals:"Festival del Tulipán (Abril), Beyoğlu Culture Route Festival (Septiembre-Octubre)",lat:"41.010",lng:"28.960",imageQuery:"Istanbul city Turkey skyline"},{id:2,name:"Moscú",country:"Rusia",bestMonths:"Primavera (Abril-Mayo), Verano (Junio-Agosto), Otoño (Septiembre-Noviembre)",festivals:"Maslenitsa (7 días antes de la Cuaresma), Día de la Victoria (9 de mayo), Internacional Art November (Noviembre)",lat:"55.752222",lng:"37.615556",imageQuery:"Moscow city Russia Kremlin"},{id:3,name:"Ereván",country:"Armenia",bestMonths:"Primavera (Abril-Junio), Otoño (Septiembre-Octubre)",festivals:"Festival de Dolma (Mayo), Festival de los Días del Vino (Junio), Festival del Té y del Café (Primeros días de Octubre), Festival de Vardavar (98 días despues de Pascua)",lat:"40.18",lng:"44.50",imageQuery:"Yerevan city Armenia"},{id:4,name:"Quba",country:"Azerbaiyán",bestMonths:"Primavera (Marzo-Mayo), Otoño (Septiembre-Octubre)",festivals:"Festival de la Manzana (Octubre-Noviembre)",lat:"41.37",lng:"48.52",imageQuery:"Quba Azerbaijan landscape mountains"},{id:5,name:"Minsk",country:"Bielorrusia",bestMonths:"Mayo, Junio, Septiembre y Octubre",festivals:"Parada de Papá Noel (31 de diciembre), Año Nuevo",lat:"53.902",lng:"27.562",imageQuery:"Minsk city Belarus architecture"},{id:6,name:"Jingdezhen",country:"China",bestMonths:"Primavera (Abril-Mayo), Otoño (Septiembre-Octubre)",festivals:"Feria de Cerámica de Taoxichuan (30 de abril - 5 de mayo y 17 - 19 de octubre)",lat:"29.29",lng:"117.20",imageQuery:"Jingdezhen ceramics China porcelain"}];async function t(){const t=await async function(){try{const e=await fetch("/api/destinations");if(!e.ok)throw new Error(`Error: ${e.status}`);return await e.json()}catch(e){return[]}}(),a=e.map(e=>({...e,isUserAdded:!1}));return[...t.map(e=>({...e,isUserAdded:!0})),...a]}let a=[];async function n(e){const t=`map-${e.id}`,a=await async function(e){try{const t=await fetch(`/api/unsplash-image?query=${encodeURIComponent(e)}`);if(!t.ok)throw new Error(`Error: ${t.status}`);return(await t.json()).url}catch(t){return`https://source.unsplash.com/featured/800x600/?${encodeURIComponent(e)}`}}(e.imageQuery);return`\n    <div class="w-full bg-white dark:bg-background-dark/50 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 grid grid-cols-1 md:grid-cols-3 gap-0 overflow-hidden mb-8 ${e.isUserAdded?"ring-2 ring-green-500":""}">\n      \x3c!-- Imagen de la ciudad --\x3e\n      <div class="w-full bg-center bg-no-repeat aspect-square md:aspect-auto bg-cover bg-gray-200" \n           style='background-image: url("${a}")'\n           title="${e.name}, ${e.country}">\n      </div>\n      \n      \x3c!-- Mapa Leaflet --\x3e\n      <div class="w-full aspect-square md:aspect-auto">\n        <div id="${t}" class="w-full h-full map-container"></div>\n      </div>\n      \n      \x3c!-- Información del destino --\x3e\n      <div class="p-6 sm:p-8 flex flex-col justify-center bg-gray-50 dark:bg-background-dark/30">\n        <div class="flex flex-col gap-2 mb-6">\n          <p class="text-2xl font-bold leading-tight text-slate-800 dark:text-slate-100">${e.name}</p>\n          <p class="text-base font-normal leading-normal text-slate-500 dark:text-slate-400">${e.country}</p>\n          ${e.isUserAdded?'<span class="text-xs text-green-600 font-medium">✓ Agregado por ti</span>':""}\n        </div>\n        \n        <div class="grid grid-cols-[auto_1fr] gap-x-4">\n          <div class="col-span-2 grid grid-cols-subgrid border-t border-t-slate-200 dark:border-t-slate-700 py-4">\n            <p class="text-sm font-medium text-slate-500 dark:text-slate-400">Mejores meses</p>\n            <p class="text-sm font-normal text-right text-slate-700 dark:text-slate-300">${e.bestMonths}</p>\n          </div>\n          \n          <div class="col-span-2 grid grid-cols-subgrid border-t border-b border-t-slate-200 dark:border-t-slate-700 border-b-slate-200 dark:border-b-slate-700 py-4">\n            <p class="text-sm font-medium text-slate-500 dark:text-slate-400">Festivales</p>\n            <p class="text-sm font-normal text-right text-slate-700 dark:text-slate-300">${e.festivals}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  `}async function r(){const e=document.getElementById("destinations-container");if(e){e.innerHTML='<div class="text-center py-8 text-slate-500">Cargando destinos...</div>';try{a=await t();let r="";for(const e of a)r+=await n(e);e.innerHTML=r,a.forEach(e=>{setTimeout(()=>{document.getElementById(`map-${e.id}`)&&function(e,t,a,n){const r=L.map(e).setView([parseFloat(t),parseFloat(a)],10);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:18}).addTo(r),L.marker([parseFloat(t),parseFloat(a)]).addTo(r).bindPopup(`<b>${n}</b>`).openPopup()}(`map-${e.id}`,e.lat,e.lng,e.name)},100)})}catch(r){e.innerHTML='<div class="text-center py-8 text-red-500">Error cargando los destinos</div>'}}}function s(){const e=document.getElementById("destination-form");e&&e.addEventListener("submit",async t=>{t.preventDefault();const a=e.querySelector('button[type="submit"]'),n=a.textContent;a.disabled=!0,a.textContent="Guardando...",a.classList.add("opacity-50","cursor-not-allowed");const s=new FormData(e),i={name:s.get("name"),country:s.get("country"),bestMonths:s.get("bestMonths"),festivals:s.get("festivals"),lat:s.get("lat"),lng:s.get("lng"),imageQuery:(d=s.get("name"),l=s.get("country"),`${d}, ${l}, city, travel`)};var d,l;if(!(i.name&&i.country&&i.lat&&i.lng))return alert("Por favor completa todos los campos obligatorios"),a.disabled=!1,a.textContent=n,void a.classList.remove("opacity-50","cursor-not-allowed");try{await async function(e){try{const t=await fetch("/api/destinations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Error: ${t.status}`);return await t.json()}catch(t){throw t}}(i);const t=document.getElementById("destinations-container");t.innerHTML,t.innerHTML='<div class="text-center py-8 text-slate-500">Actualizando destinos...</div>',await r(),e.reset(),o("¡Destino agregado correctamente! Aparecerá arriba de todo.","success")}catch(c){o("Error al agregar el destino","error"),document.getElementById("destinations-container").innerHTML=originalContent}finally{a.disabled=!1,a.textContent=n,a.classList.remove("opacity-50","cursor-not-allowed")}})}function o(e,t="info"){const a=document.createElement("div");a.className="fixed top-4 right-4 p-4 rounded-md shadow-lg z-50 "+("success"===t?"bg-green-500 text-white":"error"===t?"bg-red-500 text-white":"bg-blue-500 text-white"),a.textContent=e,document.body.appendChild(a),setTimeout(()=>{a.remove()},3e3)}document.addEventListener("DOMContentLoaded",()=>{s(),r()}),document.addEventListener("DOMContentLoaded",()=>{s(),r()})}}});
